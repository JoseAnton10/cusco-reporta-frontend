<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Estado de Reportes - Cusco Reporta</title>
  <link rel="stylesheet" href="../css/styles.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    .reports-container{background:#fff;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,.1);padding:0;margin-top:20px}
    .reports-header{padding:25px;border-bottom:1px solid #e0e0e0;background:#f8f9fa}
    .reports-header h2{color:var(--primary-color);margin-bottom:20px;font-size:1.5rem}
    .date-filters{display:flex;gap:20px;margin-bottom:15px;flex-wrap:wrap}
    .filter-group{display:flex;flex-direction:column;min-width:160px}
    .filter-group label{font-size:.9rem;margin-bottom:5px;color:#555;font-weight:600}
    .filter-group input,.filter-group select{padding:10px 12px;border:1px solid #ddd;border-radius:6px;font-size:.9rem}
    .toolbar{display:flex;gap:10px;align-items:end;flex-wrap:wrap}
    .btn{padding:10px 14px;border:none;border-radius:8px;cursor:pointer;font-weight:700}
    .btn-primary{background:#b22222;color:white}
    .btn-outline{background:white;border:1px solid #ccc;color:#333}

    .reports-table h3{padding:20px 25px 15px;color:var(--primary-color);margin:0;font-size:1.1rem;border-bottom:1px solid #e0e0e0;background:#f8f9fa}
    .meta-row{padding:10px 25px;color:#666;display:flex;gap:18px;flex-wrap:wrap}
    .meta-pill{background:#f3f3f3;border-radius:999px;padding:6px 10px;font-size:.9rem}

    table{width:100%;border-collapse:collapse}
    th,td{padding:14px 18px;text-align:left;border-bottom:1px solid #eee;vertical-align:top}
    th{background:#fafafa;font-weight:700;color:#444;font-size:.9rem}
    tr:hover{background:#fcfcfc}

    .status-badge{padding:6px 12px;border-radius:999px;font-size:.78rem;font-weight:800;display:inline-block}
    .status-reporte{background:#fff3cd;color:#856404}
    .status-proceso{background:#cce7ff;color:#004085}
    .status-solucionado{background:#d4edda;color:#155724}

    .link-btn{border:none;background:#eee;padding:8px 10px;border-radius:10px;cursor:pointer;font-weight:700}
    .muted{color:#777}

    /* Modal */
    #modalDetalle{display:none; position:fixed; inset:0; background:rgba(0,0,0,.45); align-items:center; justify-content:center; z-index:9999;}
    #modalCard{background:#fff; width:min(760px, 92vw); border-radius:14px; padding:18px; box-shadow:0 10px 30px rgba(0,0,0,.2);}
    #modalHeader{display:flex; justify-content:space-between; align-items:center; gap:10px;}
    #modalTitle{margin:0; color:#8b0000;}
    #modalBody{color:#333; line-height:1.45; margin-top:10px;}
    #modalClose{border:none; background:#eee; padding:8px 12px; border-radius:10px; cursor:pointer; font-weight:800;}

    @media (max-width:768px){
      .date-filters{flex-direction:column;gap:10px}
      .filter-group{min-width:100%}
      table{font-size:.85rem}
      th,td{padding:10px 12px}
    }
  </style>
</head>

<body>
  <header class="topbar">
    <div class="topbar__logo">
      <img src="../assents/images/CuscoReporta.png" alt="Cusco Reporta Logo">
    </div>
    <nav class="topbar__menu">
      <a href="index.html">Inicio</a>
      <a href="sobre_nosotros.html">Sobre nosotros</a>
      <a href="ayuda.html">Ayuda</a>
    </nav>
  </header>

  <div class="container">
    <aside class="sidebar" style="display:flex;flex-direction:column;justify-content:flex-start;">
      <div class="sidebar__user" style="margin-bottom:10px;">
        <div class="sidebar__avatar"><i class="fa-solid fa-user"></i></div>
        <div class="sidebar__info">
          <h3 id="nombreUsuario">Cargando...</h3>
          <p id="rolUsuario">Cargando...</p>
        </div>
      </div>

      <ul class="sidebar__menu" style="margin-top:0;padding-top:0;list-style:none;">
        <li><a href="perfil_usuario.html"><i class="fa-solid fa-id-card" style="width:20px;"></i><span style="margin-left:8px;">Ver perfil</span></a></li>

        <!-- ✅ SOLO UN LINK correcto -->
        <li><a href="reportar_denuncia.html"><i class="fa-solid fa-triangle-exclamation" style="width:20px;"></i><span style="margin-left:8px;">Reportar / Denunciar</span></a></li>

        <li><a href="lista_incidencias.html" class="active"><i class="fa-solid fa-list-check" style="width:20px;"></i><span style="margin-left:8px;">Estado de reportes</span></a></li>
        <li><a href="MapaIncidiencias(Ciudadano).html"><i class="fa-solid fa-map-location-dot" style="width:20px;"></i><span style="margin-left:8px;">Mapa de incidencias</span></a></li>
        <li><a href="notificaciones.html"><i class="fa-solid fa-bell" style="width:20px;"></i><span style="margin-left:8px;">Notificaciones</span></a></li>
      </ul>

      <button class="logout-btn" id="logoutBtn" style="margin-top:auto;">
        <i class="fa-solid fa-right-from-bracket"></i> Cerrar sesión
      </button>
    </aside>

    <main class="main-content">
      <div>
        <h1>Estado de Reportes</h1>
        <p class="muted" style="margin-top:10px;">
          Consulta tus reportes: tipo, categoría, ubicación, estado y detalle.
        </p>
      </div>

      <div class="reports-container">
        <div class="reports-header">
          <h2>LISTADO DE INCIDENCIAS</h2>

          <div class="date-filters">
            <div class="filter-group">
              <label for="fecha-inicio">Desde</label>
              <input type="date" id="fecha-inicio">
            </div>

            <div class="filter-group">
              <label for="fecha-fin">Hasta</label>
              <input type="date" id="fecha-fin">
            </div>

            <div class="filter-group">
              <label for="estado">Estado</label>
              <select id="estado">
                <option value="todos">Todos</option>
                <option value="reporte">Reporte (Recibido)</option>
                <option value="proceso">En Proceso</option>
                <option value="solucionado">Solucionado</option>
              </select>
            </div>

            <div class="toolbar">
              <button class="btn btn-primary" id="btnBuscar" type="button">Buscar</button>
              <button class="btn btn-outline" id="btnLimpiar" type="button">Limpiar</button>
            </div>
          </div>
        </div>

        <div class="reports-table">
          <h3>REPORTES RECIBIDOS</h3>

          <div class="meta-row">
            <span class="meta-pill">Total: <strong id="totalInc">0</strong></span>
            <span class="meta-pill" id="estadoCarga">Listo</span>
          </div>

          <table>
            <thead>
              <tr>
                <th>ID</th>
                <th>Fecha</th>
                <th>Tipo</th>
                <th>Categoría</th>
                <th>Título</th>
                <th>Ubicación</th>
                <th>Estado</th>
                <th>Detalle</th>
              </tr>
            </thead>
            <tbody id="tbodyInc">
              <tr>
                <td colspan="8" class="muted">Usa “Buscar” para cargar incidencias.</td>
              </tr>
            </tbody>
          </table>

          <p id="msgLista" class="muted" style="padding: 10px 25px;"></p>
        </div>
      </div>
    </main>
  </div>

  <!-- Modal detalle -->
  <div id="modalDetalle">
    <div id="modalCard">
      <div id="modalHeader">
        <h3 id="modalTitle">Detalle de incidencia</h3>
        <button id="modalClose">Cerrar</button>
      </div>
      <hr style="margin:12px 0;">
      <div id="modalBody"></div>
    </div>
  </div>

  <script src="../js/lista_incidencias.js"></script>
</body>
</html>
